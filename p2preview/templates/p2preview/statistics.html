{% extends './base.html' %}
{% block title %}Add Activity{% endblock %}

{% load staticfiles%}

{% block extrastyles %}
    <script type="text/javascript" src="{% static 'p2preview/js/highcharts.js' %}" ></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'p2preview/css/statistics.css' %}"/>
{% endblock %}

{% block body %}
  <div class="container">
    <div class="row justify-content-center align-items-center">
      <div class="col-sm-12">
        <div class="activityList">
          <div class="container-fluid">
            <div class="row">
              <div class="col-sm-12">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" id="individual-tab" data-toggle="tab" href="#individual" role="tab" aria-controls="individual" aria-selected="true">Individual Stats</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="summary-tab" data-toggle="tab" href="#summary" role="tab" aria-controls="summary" aria-selected="false">Summary Stats</a>
                  </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                  <div class="tab-pane fade show active" id="individual" role="tabpanel" aria-labelledby="individual-tab">
                    <table class="table table-hover table-bordered">
                        <thead>
                            <tr>
                              <th>#</th>
                              <th>Review Of</th>
                              <th>Reviewed By</th>
                              <th>Criteria</th>
                              <th>Response</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for indi in individual %}
                            <tr>
                                <th scope="row">{{ forloop.counter }}</th>
                                {% if activity.textOrImage %}
                                  <td>Text:- {{ indi.reviewOf.text }}<br>Group Name:- {{ indi.reviewOf.groupId }}</td>
                                {% else %}
                                  <td>{{ indi.reviewOf.fileURL }}</td>
                                {% endif %}

                                <td>
                                  Group Id:- {{ indi.reviewBy.groupId }} <br>
                                  Group Name:- {{ indi.reviewBy.groupName }} <br>
                                  Group members:- <br>
                                  {% for mem in indi.reviewBy.groupMembers %}
                                     {{ forloop.counter }} Name:- {{ mem.name }} <br>
                                     Roll No:- {{ mem.rollNo }} <br>
                                     Email:- {{ mem.email }} <br>
                                  {% endfor %}
                                </td>
                                <td>
                                  {% for criteria in indi.criterias %}
                                     {{ forloop.counter }} Description:- {{ criteria.genericId.description }} <hr>
                                  {% endfor %}
                                </td>
                                <td>
                                  {% for response in indi.responses %}
                                     {{ forloop.counter }} Response:- {{ response.response }} <br>
                                     Comment:- {{ response.comment }} <hr>
                                  {% endfor %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                  </div>
                  <div class="tab-pane fade" id="summary" role="tabpanel" aria-labelledby="summary-tab">
                    <div id="container" style="min-width: 310px;  margin: 0 auto"></div>
                  </div>
                </div>
              </div>
            </div>
        </div>
      </div>
    </div>
    <!--end forloop-->
  </div>
{% endblock %}
{% block extrajavascripts %}
<script>
  Highcharts.chart('container', {
    chart: {
        type: 'bar'
    },
    title: {
        text: 'Response Summary for Activity XYZ'
    },
    xAxis: {
        categories: {{ criterias|safe }}
    },
    yAxis: {
        min: 0,
        title: {
            text: '% Selection for each option'
        }
    },
    legend: {
        reversed: true
    },
    plotOptions: {
        series: {
            stacking: 'normal'
        }
    },
    series: [{
        name: 'Option A',
        data: [25, 30, 43, 7, 20]
    }, {
        name: 'Option B',
        data: [25, 20, 30, 20, 37]
    }, {
        name: 'Option C',
        data: [25, 10, 22, 29, 23]
    }, {
        name: 'Option D',
        data: [25, 40, 5, 44, 20]
    }]
});
</script>
{% endblock %}
